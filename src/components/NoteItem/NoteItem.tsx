import { FC, useState } from "react";
import { useNavigate } from "react-router-dom";
import { deleteNote, setArchive } from "../../store/slices/notesSlice";
import { useAppDispatch } from "../../store/store";
import { INote } from "../../types";
import st from "./NoteItem.module.scss";

const svgIcons = [
    <svg
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 307.252 307.252"
    >
        <path
            id="XMLID_564_"
            d="M184.581,230.833l9.521-100.238c0.575-6.048,5.931-10.48,11.991-9.911
	c6.048,0.575,10.485,5.943,9.911,11.991l-9.521,100.238c-0.541,5.694-5.332,9.961-10.938,9.961c-0.348,0-0.699-0.017-1.053-0.05
	C188.444,242.249,184.007,236.881,184.581,230.833z M45.306,37.023h216.644c6.075,0,11-4.925,11-11s-4.925-11-11-11h-61.998
	c0.49-1.246,0.759-2.604,0.759-4.023c0-6.075-4.925-11-11-11h-72.165c-6.075,0-11,4.925-11,11c0,1.42,0.269,2.777,0.759,4.023
	H45.306c-6.075,0-11,4.925-11,11S39.23,37.023,45.306,37.023z M153.624,260.644c6.075,0,11-4.925,11-11V113.864
	c0-6.075-4.925-11-11-11s-11,4.925-11,11v135.779C142.624,255.719,147.549,260.644,153.624,260.644z M273.279,68.477l-25.58,228.996
	c-0.622,5.568-5.329,9.779-10.932,9.779H70.484c-5.603,0-10.31-4.211-10.932-9.779L33.973,68.477
	c-0.348-3.11,0.646-6.222,2.733-8.555c2.086-2.333,5.068-3.666,8.198-3.666h217.443c3.13,0,6.112,1.333,8.198,3.666
	C272.633,62.255,273.627,65.366,273.279,68.477z M250.051,78.256H57.201l23.123,206.996h146.604L250.051,78.256z M100.772,232.913
	c0.54,5.694,5.33,9.961,10.938,9.961c0.348,0,0.699-0.017,1.053-0.05c6.048-0.575,10.485-5.943,9.911-11.991l-9.52-100.238
	c-0.575-6.048-5.938-10.484-11.991-9.911c-6.048,0.575-10.485,5.943-9.911,11.991L100.772,232.913z"
        />
    </svg>,
    <svg
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 612 612.001"
    >
        <path
            d="M305.058,329.286V570.82l192.293-36.491V416.644c0-4.926,4.291-8.752,9.185-8.19l23.658,3.661
       c4.162,0.478,7.305,4.001,7.305,8.19v136.717c0,3.885-2.713,7.243-6.512,8.061l-210.5,45.261
       c-10.172,2.188-20.691,2.211-30.873,0.069L81.373,566.609c-3.738-0.786-6.446-4.037-6.545-7.854L71.23,419.907
       c-0.112-4.354,3.181-8.046,7.521-8.427l176.886-15.543c3.068-0.269,5.73-2.226,6.902-5.074l26.648-64.716
       C292.628,317.796,305.058,320.254,305.058,329.286z M69.23,250.204L13.721,368.855c-2.713,5.798,1.928,12.34,8.297,11.697
       l208.464-21.064c2.946-0.298,5.505-2.152,6.707-4.858l67.075-151.111l-229.056,42.07C72.587,246.071,70.36,247.79,69.23,250.204z
        M304.264,203.518l70.976,155.837c1.24,2.723,3.859,4.561,6.842,4.801l208.069,16.732c6.271,0.505,10.773-5.916,8.163-11.64
       L544.05,250.284c-1.122-2.46-3.38-4.213-6.041-4.692L304.264,203.518z M245.942,80.473l51.515,89.207
       c3.967,6.869,13.882,6.868,17.848,0l51.504-89.207c3.967-6.87-0.991-15.457-8.923-15.457h-25.748v-54.71
       C332.138,4.614,327.525,0,321.833,0h-30.914c-5.691,0-10.305,4.614-10.305,10.305v54.71h-25.749
       C246.933,65.015,241.975,73.603,245.942,80.473z"
        />
    </svg>,
    <svg
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 612 612.001"
    >
        <path
            d="M581.892,397.353l-44.439-3.545v169.847L320.445,610.32c-10.142,2.227-20.694,2.227-30.835,0.083L81.341,566.622
       c-3.71-0.824-6.432-4.04-6.514-7.832L71.2,419.943c-0.082-4.37,3.215-8.08,7.503-8.492l176.937-15.5
       c3.051-0.247,5.689-2.227,6.844-5.112l42.544-103.227v283.216l192.271-36.525V390.51l-113.264-7.183
       c-9.152-0.581-17.232-6.177-20.994-14.541l-58.673-130.479l-58.952,132.826c-1.236,2.721-3.792,4.535-6.678,4.864L30.222,397.022
       c-6.349,0.66-10.966-5.854-8.245-11.707L77.466,266.67c1.154-2.391,3.38-4.123,5.936-4.617l213.875-39.246l7.091-1.319l6.924,1.236
       l218.492,39.329c2.639,0.495,4.864,2.226,6.019,4.699l54.252,118.975C592.694,391.499,588.159,397.848,581.892,397.353z
        M357.869,109.817h-25.75v54.711c0,5.691-4.613,10.305-10.304,10.305h-30.914c-5.691,0-10.305-4.614-10.305-10.305v-54.711h-25.748
       c-7.932,0-12.89-8.587-8.924-15.457L297.43,5.152c3.966-6.87,13.88-6.87,17.847-0.001l51.515,89.208
       C370.759,101.229,365.802,109.817,357.869,109.817z"
        />
    </svg>,
];

interface NoteItemProps
    extends Pick<
        INote,
        | "title"
        | "slug"
        | "content"
        | "creationDate"
        | "category"
        | "parsedDates"
    > {
    type: "active" | "archive";
}

const NoteItem: FC<NoteItemProps> = ({
    type,
    title,
    slug,
    content,
    creationDate,
    category,
    parsedDates,
}) => {
    const navigate = useNavigate();
    const [showOptions, setshowOptions] = useState(false);
    const dispatch = useAppDispatch();

    return (
        <div className={st.root}>
            {showOptions && (
                <div className={st.options}>
                    <span
                        title="delete"
                        onClick={() => dispatch(deleteNote(slug))}
                    >
                        {svgIcons[0]}
                    </span>
                    <span
                        title="archive / unarchive"
                        onClick={() => dispatch(setArchive(slug))}
                    >
                        {type === "active" ? svgIcons[1] : svgIcons[2]}
                    </span>
                </div>
            )}
            <div className={st.top}>
                <h2 onClick={() => (type === "active" ? navigate(slug) : null)}>
                    {title}
                </h2>
                <svg
                    onClick={() => setshowOptions(!showOptions)}
                    version="1.1"
                    viewBox="0 0 194.828 194.828"
                >
                    <path
                        d="M19.483,77.931C8.741,77.931,0,86.672,0,97.414s8.741,19.483,19.483,19.483c10.742,0,19.483-8.741,19.483-19.483
				S30.225,77.931,19.483,77.931z M19.483,109.103c-6.446,0-11.69-5.244-11.69-11.69c0-6.446,5.244-11.69,11.69-11.69
				c6.446,0,11.69,5.244,11.69,11.69C31.172,103.86,25.929,109.103,19.483,109.103z"
                    />
                    <path
                        d="M97.414,77.931c-10.742,0-19.483,8.741-19.483,19.483s8.741,19.483,19.483,19.483s19.483-8.741,19.483-19.483
				S108.156,77.931,97.414,77.931z M97.414,109.103c-6.446,0-11.69-5.244-11.69-11.69c0-6.446,5.244-11.69,11.69-11.69
				s11.69,5.244,11.69,11.69C109.103,103.86,103.86,109.103,97.414,109.103z"
                    />
                    <path
                        d="M175.345,77.931c-10.742,0-19.483,8.741-19.483,19.483s8.741,19.483,19.483,19.483s19.483-8.741,19.483-19.483
				S186.087,77.931,175.345,77.931z M175.345,109.103c-6.446,0-11.69-5.244-11.69-11.69c0-6.446,5.244-11.69,11.69-11.69
				c6.446,0,11.69,5.244,11.69,11.69C187.034,103.86,181.791,109.103,175.345,109.103z"
                    />
                </svg>
            </div>

            <p className={st.content}>{content}</p>
            <div className={st.stats}>
                <p>{category}</p>
                <p>{creationDate}</p>
            </div>
            <div className={st.dates}>
                {parsedDates.map((i) => (
                    <span key={i}>{i}</span>
                ))}
            </div>
        </div>
    );
};

export default NoteItem;
